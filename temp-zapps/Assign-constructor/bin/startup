#!/bin/sh
set -e

docker-compose -f docker-compose.zapp.yml down -v

sleep 5

docker-compose -f docker-compose.zapp.yml up -d ganache
docker-compose -f docker-compose.zapp.yml up -d zokrates

sleep 5

read -p "Please enter your constructor parameters separated by commas:" inputs

  docker-compose -f docker-compose.zapp.yml run --rm zapp node --experimental-repl-await -e "import('/app/orchestration/cnstrctr.mjs').then(async file => await Promise.resolve(file.default(${inputs})))"

docker-compose -f docker-compose.zapp.yml up -d deployer

sleep 25

docker-compose -f docker-compose.zapp.yml up -d timber

sleep 10

docker-compose -f docker-compose.zapp.yml up -d zapp
